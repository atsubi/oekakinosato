<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>Hello</title>
    <script type="text/javascript">

      // XMLHttpRequest オブジェクトを取得するためのユーザ定義関数
      function getXHR() {
        var req;
        try {
          req = new XMLHttpRequest();
        } catch(e) {
          try {
            req = new ActiveXObject("Msxml2.XMLHTTP");
          } catch(e) {
            req = new ActiveXObject("Microsoft.XMLHTTP");
          }
        }
        return req;
      }

      // 送信ボタンを押した場合に処理される
      function asyncSend() {
        req = getXHR();
        // 非同期通信の処理
        req.onreadystatechange = function() {
          var result = document.getElementById("result");

          if( req.readyState == 4 ) {  // 通信完了時
              if( req.status == 200 ) {   // 通信成功
                result.innerHTML = req.responseText; 
              } else {                    // 通信失敗
                result.innerHTML = req.status;
              }
          } else {
            result.innerHTML = "通信中・・・"
          }
        }
        
        // サーバとの非同期通信を開始
        req.open("GET", "/cgi-bin/hello1_2.rb?name=" +
          encodeURIComponent(document.your_name.name.value), true);
        req.send(null);
      }

      // 削除を押した時の動作
      function clearText() {
          document.getElementById("result").innerHTML="";
      }

    </script>
  </head>
  <body>
    <h1>連想クイズゲーム</h1>
    <h3>非同期通信のテスト</h3>
    クライアントからGETで送られたデータをサーバ側で非同期に処理をする。<br>
    送信ボタンを押すとサーバー側のhello.rbが実行される。<br>
    下の線以下をサーバサイドのスクリプトで書き換える感じになるかな？<br>
    <a href="index2.html">バージョン2</a>
    <hr>
    <form name="your_name">
      <label>名前：
	<input type="text" name="name" size="15"></label>
      <input type="button" name="submit" value="送信" onclick="asyncSend()">
      <input type="button" name="delete" value="削除" onclick="clearText()">
    </form>
    <div id="result"></div>
  </body>
</html>

	  
